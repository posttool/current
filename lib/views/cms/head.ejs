
<script src="/js/lib/moment.min.js"></script>
<script src="/js/lib/ejs_production.js"></script>
<script src="/js/lib/ck/ckeditor.js"></script>
<script src="/js/lib/codemirror.js"></script>
<script src="/js/lib/jquery.transit.js"></script>
<script src="/js/lib/jquery.fileupload.js"></script>
<script src="/js/lib/jquery.iframe-transport.js"></script>
<script src="/js/lib/jquery.nearest.js"></script>

<link href="/css/form_workspace.css" rel="stylesheet">
<link href="/css/codemirror.css" rel="stylesheet">

<script src="/js/util.js"></script>
<script src="/js/layers.js"></script>
<script src="/js/form.js"></script>
<script src="/js/form_fields.js"></script>
<script src="/js/form_workspace.js"></script>
<script>form_fields['page_field'] = form_field_page_layout;</script>
<script src="/js/browse.js"></script>
<script src="/js/app.js"></script>

<script>
var containerHttp = <% if (containerHttp) { %>"<%- containerHttp %>/";<% } else {%>null<% } %>;
<% if (models) { %>
<%
var t = {};
for (var p in models)
    t[p] = models[p].meta.name;
t = JSON.stringify(t);
%>
var __templates = <%-t%>;
function render_template(type, object)
{
    try {
        return new EJS({text: __templates[type]}).render(object);
    } catch (e) {
        console.error(e);
        return "";
    }
}
<% } %>

<% if (workflow) { %>
var __states = <%- JSON.stringify(workflow.states) %>;
function get_state_name(code) {
    for (var i=0; i<__states.length; i++)
        if (__states[i].code == code)
            return __states[i].name;
    return '';
}
var __transitions = <%- JSON.stringify(workflow.transitions) %>;
function get_state_transitions(code) {
    for (var i=0; i<__transitions.length; i++)
        if (__transitions[i].from == code)
            return __transitions[i].to;
    return [];
}
<% } %>
</script>